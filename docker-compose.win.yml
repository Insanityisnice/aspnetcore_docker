version: "3"
services:
  sql:
    image: microsoft/mssql-server-windows-developer
    environment:
      - sa_password=Password1 
      - ACCEPT_EULA=Y
      - attach_dbs=[{'dbName':'ASPState','dbFiles':['C:\\temp\\ASPState.mdf','C:\\temp\\ASPState_log.ldf']}, {'dbName':'EngagementCenterDb','dbFiles':['C:\\temp\\DEVFARM_EC2.mdf','C:\\temp\\DEVFARM_EC2_log.ldf']}]
    volumes:
      - C:/temp/:C:/temp/
    ports:
      - "1433:1433"
    healthcheck:
      test: [ "CMD", "sqlcmd", "-U", "sa", "-P", "Password1", "-Q", "select 1" ]
      interval: 1s
      retries: 30

# Required for bug in windows containers on older versions.
networks:
  default:
    external:
      name: nat